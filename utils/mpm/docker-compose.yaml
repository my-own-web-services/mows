# Docker Compose build configuration for mpm
#
# This file serves two purposes:
# 1. Enables `docker compose build` as an alternative to build.sh
# 2. Marks this package for cargo-workspace-docker detection (--all flag)
#
# For production builds, use build.sh which provides additional features
# like architecture selection and output directory configuration.

services:
    mpm:
        build:
            context: "."
            dockerfile: Dockerfile
            tags:
                - ${REGISTRY:-localhost:5000}/${SERVICE_NAME}
            additional_contexts:
                mows-common-rust: ../mows-common-rust
                lock: ../../
            args:
                - PROFILE=${PROFILE:-release}
                - SERVICE_NAME=${SERVICE_NAME}
                - APP_STAGE_IMAGE=${APP_STAGE_IMAGE:-scratch}
            target: ${TARGET:-binary}
