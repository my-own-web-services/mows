apiVersion: vault.k8s.mows.cloud/v1
kind: VaultResource
metadata:
    name: pektin-transit
    namespace: default
spec:
    secretEngine:
        transit: {}
# should create a secret engine of type transit at the path mows-core-secrets-vrc/pektin/dns-signing
---
apiVersion: vault.k8s.mows.cloud/v1
kind: VaultResource
metadata:
    name: pektin-policies
    namespace: default
spec:
    secretEngine:
        kv-v2:
            kvData:
                some_path:
                    pektin-zertificat: "hello world"
---
apiVersion: vault.k8s.mows.cloud/v1
kind: VaultResource
metadata:
    name: pektin-kubernetes
    namespace: default
spec:
    authEngine:
        kubernetes:
            roles:
                pektin-api:
                    serviceAccountName: pektin-api
                    policyIds: ["pektin-api-policy"]
---
apiVersion: vault.k8s.mows.cloud/v1
kind: VaultResource
metadata:
    name: pektin-api-policy
    namespace: default
spec:
    engineAccessPolicy:
        subPolicies:
            - engineId: pektin-transit
              engineType: secret
              subPath: "*"
              capabilities: ["update", "read"]
            - engineId: pektin-policies
              engineType: secret
              subPath: "*"
              capabilities: ["read"]
