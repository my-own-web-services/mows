{{- $config :=  yamlFile "../../config.yml" -}}
{{- $interosseaWebHostname := joindomain $config.interossea.web.publicHostname.subdomain (ternary "localhost" $config.interossea.web.publicHostname.domain (eq $config.routing "local")) -}}
{{- $interosseaServerHostname := joindomain $config.interossea.server.publicHostname.subdomain (ternary "localhost" $config.interossea.server.publicHostname.domain (eq $config.routing "local")) -}}
{{- $filezWebHostname := joindomain $config.filez.web.publicHostname.subdomain (ternary "localhost" $config.filez.web.publicHostname.domain (eq $config.routing "local")) -}}
variablePrefix: "$"

magicLink:
    cooldownMinutes: 1
    expirationMinutes: 10
    skipIpCheck: true

keyFolder: /keys/

services:
    - id: filez
      allowedOrigins: [{{ ternary "https://" "http://" $config.tls true }}{{ $filezWebHostname}}]

mail:
    username: {{ $config.interossea.server.mail.username}}
    password: $INTEROSSEA_MAIL_PASSWORD
    smtpServer: {{ $config.interossea.server.mail.smtpServer}}
    fromName: {{ $config.interossea.server.mail.fromName}}
    fromAddress: {{ $config.interossea.server.mail.fromAddress}}
    userAgent: {{ $config.interossea.server.mail.userAgent}}
    replyTo: {{ $config.interossea.server.mail.replyTo}}

http:
    internalAddress: "[::]:80"
    host: {{ $interosseaServerHostname }}
    protocol: {{ ternary "https" "http" $config.tls }}

db:
    url: mongodb://root:$MONGO_INITDB_ROOT_PASSWORD@interosseadb.localhost:{{ $config.interossea.server.db.port }}

uiOrigin: {{ ternary "https://" "http://" $config.tls true }}{{ $interosseaWebHostname}}


dev: