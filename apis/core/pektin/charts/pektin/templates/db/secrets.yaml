apiVersion: generators.external-secrets.io/v1alpha1
kind: Password
metadata:
    name: password-generator
spec:
    length: 100
    digits: 25
    symbols: 25
    symbolCharacters: "!"
    noUpper: false
    allowRepeat: true
---
apiVersion: external-secrets.io/v1alpha1
kind: PushSecret
metadata:
  name: pushsecret-examplexxxxyyxxx # Customisable
spec:
    secretStoreRefs:
        - name: default
          kind: ClusterSecretStore
    selector:
      generatorRef:
        apiVersion: generators.external-secrets.io/v1alpha1
        kind: Password
        name: password-generator
    data:
      - match:
          secretKey: password
          remoteRef:
            remoteKey: password-secret
            property: password
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: template
spec:
  secretStoreRef:
    name: default
    kind: ClusterSecretStore
  target:
    template:
      engineVersion: v2
      data:
        aclFile: |
            user default off
            user db-pektin-server on resetchannels allkeys -@all +GET +MGET +KEYS +SELECT "{{ `{{ .password | sha256sum }}` }}"
  dataFrom:
  - extract:
      
