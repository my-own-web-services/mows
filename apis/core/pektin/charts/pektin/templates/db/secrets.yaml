apiVersion: generators.external-secrets.io/v1alpha1
kind: Password
metadata:
    name: password-generator
spec:
    length: 100
    digits: 25
    symbols: 25
    symbolCharacters: "-_"
    noUpper: false
    allowRepeat: true
---
apiVersion: external-secrets.io/v1alpha1
kind: PushSecret
metadata:
  name: pushsecret-examplexxxx # Customisable
spec:
    secretStoreRefs:
        - name: default
          kind: ClusterSecretStore
    selector:
      secret:
        name: test
      generatorRef:
        apiVersion: generators.external-secrets.io/v1alpha1
        kind: Password
        name: password-generator
---
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: template
spec:
  secretStoreRef:
    name: default
    kind: ClusterSecretStore
  target:
    template:
      engineVersion: v2
      data:
        aclFile: |
            user default off
            user db-pektin-server on resetchannels allkeys -@all +GET +MGET +KEYS +SELECT "{{ `{{ .password | sha256sum }}` }}"
  data:
  - secretKey: password
    remoteRef:
      key: /password-secret