{"openapi":"3.1.0","info":{"title":"server","description":"","license":{"name":""},"version":"0.0.1"},"paths":{"/api/auth/check":{"post":{"operationId":"check_resource_access","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CheckResourceAccessRequestBody"}}},"required":true},"responses":{"200":{"description":"Checks if the requested resources are available to this user","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse_CheckResourceAccessResponseBody"}}}}}}},"/api/file_groups/list_files":{"post":{"operationId":"list_files","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ListFilesRequestBody"}}},"required":true},"responses":{"200":{"description":"Lists the files in a given group","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse_ListFilesResponseBody"}}}}}}},"/api/files/content/get/{file_id}/{app_id}/{app_path}":{"get":{"operationId":"get_file_content","parameters":[{"name":"file_id","in":"path","description":"The ID of the file to retrieve content for","required":true,"schema":{"type":"string","format":"uuid"}},{"name":"app_id","in":"path","description":"The type of preview to retrieve, if applicable","required":true,"schema":{"type":["string","null"]}},{"name":"app_path","in":"path","description":"The path to the file preview, if applicable","required":true,"schema":{"type":["string","null"]}},{"name":"d","in":"path","description":"download the file/set the content disposition header to attachment","required":true,"schema":{"type":["boolean","null"]}},{"name":"c","in":"path","description":"request setting the caching headers for max-age in seconds","required":true,"schema":{"type":["integer","null"],"format":"int64","minimum":0}}],"responses":{"200":{"description":"Gets a single files data/content from the server"},"404":{"description":"File not found"},"500":{"description":"Internal server error retrieving file content"}}}},"/api/files/create":{"post":{"operationId":"create_file","requestBody":{"content":{"application/octet-stream":{}}},"responses":{"200":{"description":"Created a file on the server","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse_CreateFileResponseBody"}}}}}}},"/api/files/meta/get":{"post":{"operationId":"get_files_metadata","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetFilesMetaRequestBody"}}},"required":true},"responses":{"200":{"description":"Gets the metadata for any number of files","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse_GetFileMetaResBody"}}}}}}},"/api/files/meta/update":{"post":{"operationId":"update_files_metadata","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateFilesMetaRequestBody"}}},"required":true},"responses":{"200":{"description":"Updates the metadata for any number of files","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse_EmptyApiResponse"}}}}}}},"/api/files/tus/head/{file_id}":{"head":{"operationId":"tus_head","parameters":[{"name":"file_id","in":"path","description":"The ID of the file to check for upload status","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"File exists and is ready to resume upload"},"400":{"description":"Bad request, missing or invalid headers"},"404":{"description":"File not found"},"412":{"description":"Precondition failed due to missing or invalid Tus-Resumable header"}}}},"/api/files/tus/patch/{file_id}":{"patch":{"operationId":"tus_patch","parameters":[{"name":"file_id","in":"path","description":"The ID of the file to check for upload status","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"content":{"application/octet-stream":{}}},"responses":{"204":{"description":"File was successfully patched"},"400":{"description":"Bad request, missing or invalid headers"},"404":{"description":"File not found"},"412":{"description":"Precondition failed, likely due to missing or invalid Tus-Resumable header"}}}},"/api/health":{"get":{"operationId":"get_health","responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse_HealthResBody"}}}}}}},"/api/users/apply":{"post":{"operationId":"apply_user","responses":{"200":{"description":"Applied own user","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse_ApplyUserResponseBody"}}}}}}},"/api/users/get":{"post":{"operationId":"get_users","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetUsersReqBody"}}},"required":true},"responses":{"200":{"description":"Gets Users","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApiResponse_GetUsersResBody"}}}}}}}},"components":{"schemas":{"ApiResponseStatus":{"type":"string","enum":["Success","Error"]},"ApiResponse_ApplyUserResponseBody":{"type":"object","required":["message","status"],"properties":{"data":{"type":"object","required":["user_id"],"properties":{"user_id":{"type":"string","format":"uuid"}}},"message":{"type":"string"},"status":{"$ref":"#/components/schemas/ApiResponseStatus"}}},"ApiResponse_CheckResourceAccessResponseBody":{"type":"object","required":["message","status"],"properties":{"data":{"type":"object","required":["auth_evaluations"],"properties":{"auth_evaluations":{"type":"array","items":{"$ref":"#/components/schemas/AuthEvaluation"}}}},"message":{"type":"string"},"status":{"$ref":"#/components/schemas/ApiResponseStatus"}}},"ApiResponse_CreateFileResponseBody":{"type":"object","required":["message","status"],"properties":{"data":{"type":"object","required":["file_id"],"properties":{"file_id":{"type":"string"}}},"message":{"type":"string"},"status":{"$ref":"#/components/schemas/ApiResponseStatus"}}},"ApiResponse_EmptyApiResponse":{"type":"object","required":["message","status"],"properties":{"data":{"default":null},"message":{"type":"string"},"status":{"$ref":"#/components/schemas/ApiResponseStatus"}}},"ApiResponse_GetFileMetaResBody":{"type":"object","required":["message","status"],"properties":{"data":{"type":"object","required":["files_meta"],"properties":{"files_meta":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/FileMeta"},"propertyNames":{"type":"string","format":"uuid"}}}},"message":{"type":"string"},"status":{"$ref":"#/components/schemas/ApiResponseStatus"}}},"ApiResponse_GetUsersResBody":{"type":"object","required":["message","status"],"properties":{"data":{"type":"object","required":["users_meta"],"properties":{"users_meta":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/UserMeta"},"propertyNames":{"type":"string","format":"uuid"}}}},"message":{"type":"string"},"status":{"$ref":"#/components/schemas/ApiResponseStatus"}}},"ApiResponse_HealthResBody":{"type":"object","required":["message","status"],"properties":{"data":{"type":"object"},"message":{"type":"string"},"status":{"$ref":"#/components/schemas/ApiResponseStatus"}}},"ApiResponse_ListFilesResponseBody":{"type":"object","required":["message","status"],"properties":{"data":{"type":"object","required":["files","total_count"],"properties":{"files":{"type":"array","items":{"$ref":"#/components/schemas/File"}},"total_count":{"type":"integer","format":"int64"}}},"message":{"type":"string"},"status":{"$ref":"#/components/schemas/ApiResponseStatus"}}},"ApplyUserResponseBody":{"type":"object","required":["user_id"],"properties":{"user_id":{"type":"string","format":"uuid"}}},"AuthEvaluation":{"type":"object","required":["resource_id","is_allowed","reason"],"properties":{"is_allowed":{"type":"boolean"},"reason":{"$ref":"#/components/schemas/AuthReason"},"resource_id":{"type":"string","format":"uuid"}}},"AuthReason":{"oneOf":[{"type":"string","enum":["Owned"]},{"type":"object","required":["AllowedByDirectUserPolicy"],"properties":{"AllowedByDirectUserPolicy":{"type":"object","required":["policy_id"],"properties":{"policy_id":{"type":"string","format":"uuid"}}}}},{"type":"object","required":["AllowedByDirectGroupPolicy"],"properties":{"AllowedByDirectGroupPolicy":{"type":"object","required":["policy_id","via_user_group_id"],"properties":{"policy_id":{"type":"string","format":"uuid"},"via_user_group_id":{"type":"string","format":"uuid"}}}}},{"type":"object","required":["AllowedByResourceGroupUserPolicy"],"properties":{"AllowedByResourceGroupUserPolicy":{"type":"object","required":["policy_id","on_resource_group_id"],"properties":{"on_resource_group_id":{"type":"string","format":"uuid"},"policy_id":{"type":"string","format":"uuid"}}}}},{"type":"object","required":["AllowedByResourceGroupUserGroupPolicy"],"properties":{"AllowedByResourceGroupUserGroupPolicy":{"type":"object","required":["policy_id","via_user_group_id","on_resource_group_id"],"properties":{"on_resource_group_id":{"type":"string","format":"uuid"},"policy_id":{"type":"string","format":"uuid"},"via_user_group_id":{"type":"string","format":"uuid"}}}}},{"type":"object","required":["DeniedByDirectUserPolicy"],"properties":{"DeniedByDirectUserPolicy":{"type":"object","required":["policy_id"],"properties":{"policy_id":{"type":"string","format":"uuid"}}}}},{"type":"object","required":["DeniedByDirectGroupPolicy"],"properties":{"DeniedByDirectGroupPolicy":{"type":"object","required":["policy_id","via_user_group_id"],"properties":{"policy_id":{"type":"string","format":"uuid"},"via_user_group_id":{"type":"string","format":"uuid"}}}}},{"type":"object","required":["DeniedByResourceGroupUserPolicy"],"properties":{"DeniedByResourceGroupUserPolicy":{"type":"object","required":["policy_id","on_resource_group_id"],"properties":{"on_resource_group_id":{"type":"string","format":"uuid"},"policy_id":{"type":"string","format":"uuid"}}}}},{"type":"object","required":["DeniedByResourceGroupUserGroupPolicy"],"properties":{"DeniedByResourceGroupUserGroupPolicy":{"type":"object","required":["policy_id","via_user_group_id","on_resource_group_id"],"properties":{"on_resource_group_id":{"type":"string","format":"uuid"},"policy_id":{"type":"string","format":"uuid"},"via_user_group_id":{"type":"string","format":"uuid"}}}}},{"type":"string","enum":["NoMatchingAllowPolicy"]},{"type":"string","enum":["ResourceNotFound"]}]},"CheckResourceAccessRequestBody":{"type":"object","required":["resource_ids","resource_type","action"],"properties":{"action":{"type":"string"},"requesting_app_origin":{"type":["string","null"]},"resource_ids":{"type":"array","items":{"type":"string","format":"uuid"}},"resource_type":{"type":"string"}}},"CheckResourceAccessResponseBody":{"type":"object","required":["auth_evaluations"],"properties":{"auth_evaluations":{"type":"array","items":{"$ref":"#/components/schemas/AuthEvaluation"}}}},"CreateFileRequestBody":{"type":"object","required":["file_name"],"properties":{"file_name":{"type":"string"},"mime_type":{"type":["string","null"]},"sha256_digest":{"type":["string","null"]},"time_created":{"type":["string","null"],"format":"date-time"},"time_modified":{"type":["string","null"],"format":"date-time"}}},"CreateFileResponseBody":{"type":"object","required":["file_id"],"properties":{"file_id":{"type":"string"}}},"EmptyApiResponse":{"default":null},"File":{"type":"object","required":["id","owner_id","mime_type","name","created_time","modified_time","size","metadata","storage"],"properties":{"created_time":{"type":"string","format":"date-time"},"id":{"type":"string","format":"uuid"},"metadata":{"$ref":"#/components/schemas/FileMetadata"},"mime_type":{"type":"string"},"modified_time":{"type":"string","format":"date-time"},"name":{"type":"string"},"owner_id":{"type":"string","format":"uuid"},"sha256_digest":{"type":["string","null"]},"size":{"type":"integer","format":"int64"},"storage":{"$ref":"#/components/schemas/StorageLocation"}}},"FileMeta":{"type":"object","required":["file","tags"],"properties":{"file":{"$ref":"#/components/schemas/File"},"tags":{"type":"object","additionalProperties":{"type":"string"},"propertyNames":{"type":"string"}}}},"FileMetadata":{"type":"object","required":["private_app_data","shared_app_data","extracted_data"],"properties":{"default_preview_app_id":{"type":["string","null"],"format":"uuid"},"extracted_data":{"description":"Extracted data from the file, such as text content, metadata, etc."},"private_app_data":{"type":"object","description":"Place for apps to store custom data related to the file.\nevery app is identified by its id, and can only access its own data.","additionalProperties":{},"propertyNames":{"type":"string"}},"shared_app_data":{"type":"object","description":"Apps can provide and request shared app data from other apps on creation","additionalProperties":{},"propertyNames":{"type":"string"}}}},"GetFileMetaResBody":{"type":"object","required":["files_meta"],"properties":{"files_meta":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/FileMeta"},"propertyNames":{"type":"string","format":"uuid"}}}},"GetFilesMetaRequestBody":{"type":"object","required":["file_ids"],"properties":{"file_ids":{"type":"array","items":{"type":"string","format":"uuid"}}}},"GetUsersReqBody":{"type":"object","required":["user_ids"],"properties":{"user_ids":{"type":"array","items":{"type":"string","format":"uuid"}}}},"GetUsersResBody":{"type":"object","required":["users_meta"],"properties":{"users_meta":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/UserMeta"},"propertyNames":{"type":"string","format":"uuid"}}}},"HealthResBody":{"type":"object"},"ListFilesRequestBody":{"type":"object","required":["file_group_id"],"properties":{"file_group_id":{"type":"string","format":"uuid"},"from_index":{"type":["integer","null"],"format":"int64"},"limit":{"type":["integer","null"],"format":"int64"},"sort_by":{"type":["string","null"]},"sort_order":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/SortOrder"}]}}},"ListFilesResponseBody":{"type":"object","required":["files","total_count"],"properties":{"files":{"type":"array","items":{"$ref":"#/components/schemas/File"}},"total_count":{"type":"integer","format":"int64"}}},"SortOrder":{"type":"string","enum":["Ascending","Descending"]},"StorageLocation":{"type":"object","required":["locations"],"properties":{"locations":{"type":"object","description":"app_id -> provider_id","additionalProperties":{"type":"string"},"propertyNames":{"type":"string"}}}},"UpdateFilesMetaRequestBody":{"type":"object","required":["file_ids","files_meta"],"properties":{"file_ids":{"type":"array","items":{"type":"string","format":"uuid"}},"files_meta":{"$ref":"#/components/schemas/UpdateFilesMetaType"}}},"UpdateFilesMetaType":{"oneOf":[{"type":"object","required":["Tags"],"properties":{"Tags":{"$ref":"#/components/schemas/UpdateFilesMetaTypeTags"}}}]},"UpdateFilesMetaTypeTags":{"type":"object","required":["tags","method"],"properties":{"method":{"$ref":"#/components/schemas/UpdateFilesMetaTypeTagsMethod"},"tags":{"type":"object","additionalProperties":{"type":"string"},"propertyNames":{"type":"string"}}}},"UpdateFilesMetaTypeTagsMethod":{"type":"string","enum":["Add","Remove","Set"]},"User":{"type":"object","required":["id","display_name","created_time","modified_time","deleted","storage_limit"],"properties":{"created_time":{"type":"string","format":"date-time"},"deleted":{"type":"boolean"},"display_name":{"type":"string"},"external_user_id":{"type":["string","null"]},"id":{"type":"string","format":"uuid"},"modified_time":{"type":"string","format":"date-time"},"storage_limit":{"type":"integer","format":"int64"}}},"UserMeta":{"type":"object","required":["user"],"properties":{"user":{"$ref":"#/components/schemas/User"}}}}},"tags":[{"name":"filez-server","description":"MOWS Filez API"}]}